doctype html
html(lang="en", ng-app="EventorioApp")
  include ../layouts/head.server.jade
  include ../layouts/scripts.server.jade
  body
    include ../layouts/header.server.jade
    .content-fluid(ng-controller="UserController")
      .row-fluid(ng-show="show")
        img.img-responsive.img-user-header(src="/img/user_background.png")

        .user-header.col-lg-12
          .row-fluid
            .col-lg-4.col-lg-offset-1.col-xs-3.col-xs-offset-1
              .row
                .user-thumbnail
                  img.img-responsive.img-thumbnail.col-lg-8.hidden-xs(ng-src="{{user.picture}}")
                  img.img-responsive.col-xs-12.visible-xs(ng-src="{{user.picture}}")
              .row.hidden-xs
                .col-lg-offset-1.user-name
                  div(ng-if="user.name")
                    a.editable(ng-if="editable", style="font-size: 2em;") {{user.name}}
                    p(ng-if="!editable", style="font-size: 2em;") {{user.name}}
                  div(ng-if="!user.name")
                    a.editable(ng-if="editable", style="color: grey; font-size: 1.7em; opacity: 0.5;") Enter your name
                    p(ng-if="!editable", style="color: grey; font-size: 1.7em;") No name
              .row#userTabs.hidden-xs
                .col-lg-8.text-center
                  table.table
                    tr
                      td#followersTab
                        a(href="#", ng-click="showTab('#followersTab');")
                          | {{user.followers.length || 0}}
                          br
                          | Followers
                      td#followingTab
                        a(href="#", ng-click="showTab('#followingTab');")
                          | {{user.following.length || 0}}
                          br
                          | Following
              .row.hidden-xs
                .col-lg-8(ng-show="tab === '#followersTab'")
                  p.text-center(style="color: gray", ng-if="user.followers.length === 0") No followers
                  table.table(ng-repeat="us in user.followers")
                    tr
                      td
                        img.img.img-responsive.img-thumbnail(ng-src="{{us.picture}}")
                      td
                        a(href="/users/{{us.username}}") {{us.username}}
                      td
                        a(href="/users/{{us.username}}") {{us.name}}

                .col-lg-8(ng-show="tab === '#followingTab'")
                  table.table(ng-repeat="us in user.following")
                    tr
                      td
                        img.img.img-responsive.img-thumbnail(ng-src="{{us.picture}}")
                      td
                        a(href="/users/{{us.username}}") {{us.username}}
                      td
                        a(href="/users/{{us.username}}") {{us.name}}

              .row-fluid.hidden-xs(ng-if="global.me && !editable")
                .col-lg-8.text-center
                  button.btn.btn-success.col-lg-12(
                    ng-if="global.me.following.indexOf(user.id) === -1"
                    ng-click="follow()") Follow
                  button.btn.btn-default.btn-sm.col-lg-6.col-lg-offset-3(
                    ng-if="global.me.following.indexOf(user.id) !== -1"
                    ng-click="unfollow()") Unfollow

            .user-username.col-lg-7.col-xs-8 {{user.username}}
              .row.visible-xs
                .col-xs-12.user-name
                  div(ng-if="user.name")
                    a.editable(ng-if="editable") {{user.name}}
                    p(ng-if="!editable") {{user.name}}
                  div(ng-if="!user.name")
                    a.editable(ng-if="editable", style="color: grey; opacity: 0.5;") Enter your name
                    p(ng-if="!editable", style="color: grey;") No name

            .row.visible-xs
              .user-events.col-xs-12.visible-xs(ng-if="user.events")
                p.text-center(ng-if="user.events.length === 0", style="color: grey; opacity: 0.7") No upcoming events
                p.text-center(ng-if="user.events.length !== 0 && !editable") {{user.username}}'s upcoming events:
                p.text-center(ng-if="user.events.length !== 0 && editable") Your upcoming events:
                .col-lg-6(ng-repeat="event in user.events" event-line event="event")

            .row#userTabs.visible-xs
              .col-xs-12.text-center
                table.table
                  tr
                    td#followersTab
                      a(href="#", ng-click="showTab('#followersTab');")
                        | {{user.followers.length || 0}}
                        br
                        | Followers
                    td#followingTab
                      a(href="#", ng-click="showTab('#followingTab');")
                        | {{user.following.length || 0}}
                        br
                        | Following
            //- .row.visible-xs
            //-   .col-xs-12(ng-show="tab === '#followersTab'")
            //-     p.text-center(style="color: gray", ng-if="user.followers.length === 0") No followers
            //-     table.table(ng-repeat="us in user.followers")
            //-       tr
            //-         td
            //-           img.img.img-responsive.img-thumbnail.col-xs-2(ng-src="{{us.picture}}")
            //-         td
            //-           a(href="/users/{{us.username}}") {{us.username}}
            //-         td
            //-           a(href="/users/{{us.username}}") {{us.name}}

            //-   .col-xs-12(ng-show="tab === '#followingTab'")
            //-     table.table(ng-repeat="us in user.following")
            //-       tr
            //-         td
            //-           img.img.img-responsive.img-thumbnail.col-xs-2(ng-src="{{us.picture}}")
            //-         td
            //-           a(href="/users/{{us.username}}") {{us.username}}
            //-         td
            //-           a(href="/users/{{us.username}}") {{us.name}}

            .row.visible-xs
              .user-description.col-xs-10.col-xs-offset-1
                div(ng-if="user.desc")
                  a.editable(ng-if="editable") {{user.desc}}
                  p(ng-if="!editable") {{user.desc}}
                div(ng-if="!user.desc")
                  a.editable(ng-if="editable", style="opacity: 0.5;") Tell us something about you
                  p(ng-if="!editable") No description

            .row-fluid.visible-xs(ng-if="global.me && !editable")
              .col-xs-12.text-center
                button.btn.btn-success.col-xs-12(
                  ng-if="global.me.following.indexOf(user.id) === -1"
                  ng-click="follow()") Follow
                button.btn.btn-default.btn-sm.col-lg-6.col-xs-offset-3(
                  ng-if="global.me.following.indexOf(user.id) !== -1"
                  ng-click="unfollow()") Unfollow

          .row-fluid.hidden-xs
            .user-description.col-lg-7
              div(ng-if="user.desc")
                a.editable(ng-if="editable", style="font-size: 2em") {{user.desc}}
                p(ng-if="!editable", style="font-size: 2em") {{user.desc}}
              div(ng-if="!user.desc")
                a.editable(ng-if="editable", style="font-size: 1.7em; opacity: 0.5;") Tell us something about you
                p(ng-if="!editable", style="font-size: 2em") No description

            .user-events.col-lg-7(ng-if="user.events")
              h3(ng-if="!editable") {{user.username}}'s upcoming events:
              h3(ng-if="editable") Your upcoming events:
              .col-lg-6(ng-repeat="event in user.events")
                a(href="/events/{{event.id}}")
                  table.table
                    tr
                      td.col-lg-4
                        img.img-responsive.img-thumbnail(ng-if="event.picture", ng-src="/pictures/{{event.picture}}")
                        img.img-responsive.img-thumbnail(ng-if="!event.picture", src="/img/event_logo.jpg")
                      td
                        h3 {{event.name}}
                        .text-left
                          span {{event.readableDate}}
                          br
                          span {{event.readableTime}}
                      td
                        a(href="/users/{{event.organizator.username}}")
                          span {{event.organizator.username}}
